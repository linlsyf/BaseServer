<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>screenclubViewCount</title>
  <meta name="description" content="这是一个form页面">
  <meta name="keywords" content="form">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="icon" type="image/png" href="../assets/i/favicon.png">
  <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
  <meta name="apple-mobile-web-app-title" content="Amaze UI" />
  <link rel="stylesheet" href="../assets/css/amazeui.min.css"/>
  <link rel="stylesheet" href="../assets/css/admin.css">
  <link rel="stylesheet" href="../layui/css/layui.css"  media="all">

</head>
<body>
<script src="../layui/layui.js" charset="utf-8"></script>

<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->

<div style="padding: 20px; background-color: #F2F2F2;">
  <div class="layui-row layui-col-space15">
    <div class="layui-col-md6">
      <div class="layui-card">
        <div class="layui-card-header">访问信息</div>
        <div  id="totaldiv" class="layui-card-body">

        </div>
      </div>
    </div>
    <div class="layui-col-md6">
      <div class="layui-card">
        <div class="layui-card-header">今天访问</div>
        <div id="totaydiv" class="layui-card-body">

        </div>
      </div>
    </div>
    <div class="layui-col-md12">
      <div class="layui-card">
        <div class="layui-card-header">自定义查询</div>


              <div class="layui-card-header">
                <div class="am-g am-margin-top">
                  <label class="layui-form-label">开始</label>
                  <div class="layui-input-inline">
                    <input type="text"   class="layui-input" id="startyear"  placeholder="yyyy-MM-dd">
                  </div>

                </div>
              </div>

          <div class="layui-card-header">
            <div class="am-g am-margin-top">
              <label class="layui-form-label">结束</label>
              <div class="layui-input-inline">
                <input type="text"   class="layui-input" id="endyear"  placeholder="yyyy-MM-dd">
              </div>

            </div>
          </div>


          <div class="layui-card-header">


              <div class="am-g am-margin-top">
                <label class="layui-form-label">数量</label>
                <div class="layui-input-inline">
                  <input type="text"   class="layui-input" id="result"  placeholder="此处显示统计结果">
                </div>

              </div>

            <div class="am-form-group" >
              <div class="col-sm-9 col-sm-push-3">
                <button type="button"      id="saveBtn"  class="am-btn am-btn-primary">开始统计</button>
              </div>
            </div>


        </div>






      </div>
    </div>
  </div>




</div>
<!-- sidebar end -->

<!-- content end -->




<script src="../assets/js/zepto.min.js"></script>
<script src="../assets/js/amazeui.min.js"></script>
<script src="../assets/js/app.js"></script>

<script src="../js/glo.js">
</script>
</body>



<script type="text/javascript">


      layui.use('laydate', function(){
        var laydate = layui.laydate;

        //年月选择器
        laydate.render({
          elem: '#startyear'

        });
        //年月选择器
        laydate.render({
          elem: '#endyear'

        });



      });
    //checkLogin();
    $("#saveBtn").on("click",function(){

// 这里的this指向触发点击事件的p元素(Element)
        debugger

       var starttime = $(" #startyear").val()
       var endtime = $(" #endyear").val()

          debugger;

         if (""==starttime||""==starttime){
           alert("请选择统计时间段");
           return;
         }
      // alert("开始时间为:"+startyear+"结束时间为:"+endyear+"功能正在开发中")
      //
      //   return;
        //var zticket=getCookie("zticket")  ticket: zticket,


        var params={
            'starttime':starttime,
            'endtime':endtime
              }

        $.ajax({
            url: "/api/v1/amazonAccount/searchViewCount",
            async: false,//这一步是非常重要的，作用是设置为同步执行
            data:params,
            dataType: "json",
            traditional:true,
            crossDomain: true,
            success: function (data) {
                    debugger;
              $(" #result").val( data.data.length)
              // $(" #result") data.data.length
                    //alert(data.msg)

             //   $(location).attr('href', "/admin-exam-list.html");

            },
            fail: function (e) {
                alert("fail");
            },
            error: function (e) {
                alert("error=" + e.message);
            }

        });


    });
      function getNowFormatDate() {
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        if (month >= 1 && month <= 9) {
          month = '0' + month;
        }
        if (strDate >= 0 && strDate <= 9) {
          strDate = '0' + strDate;
        }
        var currentdate = year + '-' + month + '-' + strDate;
        return currentdate;
      }
      var paramsGet={
      }

      $.ajax({
        url: "/api/v1/amazonAccount/getViewCountMsg",
        async: false,//这一步是非常重要的，作用是设置为同步执行
        data:paramsGet,
        dataType: "json",
        traditional:true,
        crossDomain: true,
        success: function (data) {
          debugger;

           if (data.data.length>0){

             var  totalMsg= data.data[0].totalview;
              if ( ""!=data.data[0].createtime){
                totalMsg="总访问："+totalMsg+"<br>"
                totalMsg=totalMsg+ "开始日期："+ data.data[0].createtime.substr(0,11)
              }
             var  todayMsg= data.data[0].todaynum;
             if ( ""!=data.data[0].createtime){
               todayMsg="今日访问："+todayMsg+"<br>"
               todayMsg=todayMsg+ "今天日期："+ getNowFormatDate()
             }


             $("#totaldiv").html(totalMsg)
             $("#totaydiv").html(todayMsg )
           }

          // $(" #result") data.data.length
          //alert(data.msg)

          //   $(location).attr('href', "/admin-exam-list.html");

        },
        fail: function (e) {
          alert("fail");
        },
        error: function (e) {
          alert("error=" + e.message);
        }

      });




</script>



</html>
